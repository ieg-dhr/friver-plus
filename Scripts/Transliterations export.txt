Step 1: 

create view treaty_pages_transliteration_extended as 
(select treaty_pages.treaty as treaty_id, treaty_pages.transliteration, treaty_pages.page_num as page_num,
case when page_num = 1 then transliteration end as Pnr1,
case when page_num = 2 then transliteration end as Pnr2,
case when page_num = 3 then transliteration end as Pnr3,
case when page_num = 4 then transliteration end as Pnr4,
case when page_num = 5 then transliteration end as Pnr5,
case when page_num = 6 then transliteration end as Pnr6,
case when page_num = 7 then transliteration end as Pnr7,
case when page_num = 8 then transliteration end as Pnr8,
case when page_num = 9 then transliteration end as Pnr9,
case when page_num = 10 then transliteration end as Pnr10,
case when page_num = 11 then transliteration end as Pnr11,
case when page_num = 12 then transliteration end as Pnr12,
case when page_num = 13 then transliteration end as Pnr13,
case when page_num = 14 then transliteration end as Pnr14,
case when page_num = 15 then transliteration end as Pnr15,
case when page_num = 16 then transliteration end as Pnr16,
case when page_num = 17 then transliteration end as Pnr17,
case when page_num = 18 then transliteration end as Pnr18,
case when page_num = 19 then transliteration end as Pnr19,
case when page_num = 20 then transliteration end as Pnr20,
case when page_num = 21 then transliteration end as Pnr21,
case when page_num = 22 then transliteration end as Pnr22,
case when page_num = 23 then transliteration end as Pnr23,
case when page_num = 24 then transliteration end as Pnr24,
case when page_num = 25 then transliteration end as Pnr25,
case when page_num = 26 then transliteration end as Pnr26,
case when page_num = 27 then transliteration end as Pnr27,
case when page_num = 28 then transliteration end as Pnr28,
case when page_num = 29 then transliteration end as Pnr29,
case when page_num = 30 then transliteration end as Pnr30,
case when page_num = 31 then transliteration end as Pnr31,
case when page_num = 32 then transliteration end as Pnr32,
case when page_num = 33 then transliteration end as Pnr33,
case when page_num = 34 then transliteration end as Pnr34,
case when page_num = 35 then transliteration end as Pnr35,
case when page_num = 36 then transliteration end as Pnr36,
case when page_num = 37 then transliteration end as Pnr37,
case when page_num = 38 then transliteration end as Pnr38,
case when page_num = 39 then transliteration end as Pnr39,
case when page_num = 40 then transliteration end as Pnr40,
case when page_num = 41 then transliteration end as Pnr41,
case when page_num = 42 then transliteration end as Pnr42,
case when page_num = 43 then transliteration end as Pnr43,
case when page_num = 44 then transliteration end as Pnr44,
case when page_num = 45 then transliteration end as Pnr45,
case when page_num = 46 then transliteration end as Pnr46,
case when page_num = 47 then transliteration end as Pnr47,
case when page_num = 48 then transliteration end as Pnr48,
case when page_num = 49 then transliteration end as Pnr49,
case when page_num = 50 then transliteration end as Pnr50,
case when page_num = 51 then transliteration end as Pnr51,
case when page_num = 52 then transliteration end as Pnr52,
case when page_num = 53 then transliteration end as Pnr53,
case when page_num = 54 then transliteration end as Pnr54,
case when page_num = 55 then transliteration end as Pnr55,
case when page_num = 56 then transliteration end as Pnr56,
case when page_num = 57 then transliteration end as Pnr57,
case when page_num = 58 then transliteration end as Pnr58,
case when page_num = 59 then transliteration end as Pnr59,
case when page_num = 60 then transliteration end as Pnr60,
case when page_num = 61 then transliteration end as Pnr61,
case when page_num = 62 then transliteration end as Pnr62,
case when page_num = 63 then transliteration end as Pnr63,
case when page_num = 64 then transliteration end as Pnr64,
case when page_num = 65 then transliteration end as Pnr65,
case when page_num = 66 then transliteration end as Pnr66,
case when page_num = 67 then transliteration end as Pnr67,
case when page_num = 68 then transliteration end as Pnr68,
case when page_num = 69 then transliteration end as Pnr69,
case when page_num = 70 then transliteration end as Pnr70,
case when page_num = 71 then transliteration end as Pnr71,
case when page_num = 72 then transliteration end as Pnr72,
case when page_num = 73 then transliteration end as Pnr73,
case when page_num = 74 then transliteration end as Pnr74,
case when page_num = 75 then transliteration end as Pnr75,
case when page_num = 76 then transliteration end as Pnr76,
case when page_num = 77 then transliteration end as Pnr77,
case when page_num = 78 then transliteration end as Pnr78,
case when page_num = 79 then transliteration end as Pnr79,
case when page_num = 80 then transliteration end as Pnr80,
case when page_num = 81 then transliteration end as Pnr81

from _ieg_treaty as treaty
);

select * from treaty_pages_transliteration_extended

Step 2:

create view treaty_pages_transliteration_extended_pivot as 
(select treaty_id, 
max(Pnr1) as Pnr1,
max(Pnr2) as Pnr2,
max(Pnr3) as Pnr3,
max(Pnr4) as Pnr4,
max(Pnr5) as Pnr5,
max(Pnr6) as Pnr6,
max(Pnr7) as Pnr7,
max(Pnr8) as Pnr8,
max(Pnr9) as Pnr9,
max(Pnr10) as Pnr10,
max(Pnr11) as Pnr11,
max(Pnr12) as Pnr12,
max(Pnr13) as Pnr13,
max(Pnr14) as Pnr14,
max(Pnr15) as Pnr15,
max(Pnr16) as Pnr16,
max(Pnr17) as Pnr17,
max(Pnr18) as Pnr18,
max(Pnr19) as Pnr19,
max(Pnr20) as Pnr20,
max(Pnr21) as Pnr21,
max(Pnr22) as Pnr22,
max(Pnr23) as Pnr23,
max(Pnr24) as Pnr24,
max(Pnr25) as Pnr25,
max(Pnr26) as Pnr26,
max(Pnr27) as Pnr27,
max(Pnr28) as Pnr28,
max(Pnr29) as Pnr29,
max(Pnr30) as Pnr30,
max(Pnr31) as Pnr31,
max(Pnr32) as Pnr32,
max(Pnr33) as Pnr33,
max(Pnr34) as Pnr34,
max(Pnr35) as Pnr35,
max(Pnr36) as Pnr36,
max(Pnr37) as Pnr37,
max(Pnr38) as Pnr38,
max(Pnr39) as Pnr39,
max(Pnr40) as Pnr40,
max(Pnr41) as Pnr41,
max(Pnr42) as Pnr42,
max(Pnr43) as Pnr43,
max(Pnr44) as Pnr44,
max(Pnr45) as Pnr45,
max(Pnr46) as Pnr46,
max(Pnr47) as Pnr47,
max(Pnr48) as Pnr48,
max(Pnr49) as Pnr49,
max(Pnr50) as Pnr50,
max(Pnr51) as Pnr51,
max(Pnr52) as Pnr52,
max(Pnr53) as Pnr53,
max(Pnr54) as Pnr54,
max(Pnr55) as Pnr55,
max(Pnr56) as Pnr56,
max(Pnr57) as Pnr57,
max(Pnr58) as Pnr58,
max(Pnr59) as Pnr59,
max(Pnr60) as Pnr60,
max(Pnr61) as Pnr61,
max(Pnr62) as Pnr62,
max(Pnr63) as Pnr63,
max(Pnr64) as Pnr64,
max(Pnr65) as Pnr65,
max(Pnr66) as Pnr66,
max(Pnr67) as Pnr67,
max(Pnr68) as Pnr68,
max(Pnr69) as Pnr69,
max(Pnr70) as Pnr70,
max(Pnr71) as Pnr71,
max(Pnr72) as Pnr72,
max(Pnr73) as Pnr73,
max(Pnr74) as Pnr74,
max(Pnr75) as Pnr75,
max(Pnr76) as Pnr76,
max(Pnr77) as Pnr77,
max(Pnr78) as Pnr78,
max(Pnr79) as Pnr79,
max(Pnr80) as Pnr80,
max(Pnr81) as Pnr81

from treaty_pages_transliteration_extended
group by treaty_pages_ transliteration_extended.treaty_id
order by treaty_pages_transliteration_extended.treaty_id asc
);

select * from treaty_pages_transliteration_extended_pivot

